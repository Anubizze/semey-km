<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–û—Ç–º–µ–Ω–∞ –ø–∞—Ä—Ç–∏–∏</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 min-h-screen">

  <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
  <header class="bg-white border-b border-gray-200 shadow-sm">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between items-center py-4">
        <div class="flex items-center">
          <img src="{{ url_for('static', filename='images/logo_0.png') }}" alt="–õ–æ–≥–æ—Ç–∏–ø" class="h-10 w-auto mr-3">
          <div>
            <h1 class="text-xl font-bold text-gray-900">–û—Ç–º–µ–Ω–∞ –ø–∞—Ä—Ç–∏–∏</h1>
            <p class="text-sm text-gray-600">–£–∫–∞–∂–∏—Ç–µ –ø—Ä–∏—á–∏–Ω—É –æ—Ç–º–µ–Ω—ã –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–æ–π –ø–∞—Ä—Ç–∏–∏</p>
          </div>
        </div>
        <a href="/batch_list" class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-md text-sm font-medium transition-colors">
          –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É
        </a>
      </div>
    </div>
  </header>

  <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
  <main class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    
    <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–∞—Ä—Ç–∏–∏ -->
    <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6">
      <h2 class="text-lg font-semibold text-gray-900 mb-4">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–∞—Ä—Ç–∏–∏</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <p class="text-sm text-gray-600">–ù–æ–º–µ—Ä –ø–∞—Ä—Ç–∏–∏:</p>
          <p class="font-semibold text-gray-900">{{ batch.batch_number }}</p>
        </div>
        <div>
          <p class="text-sm text-gray-600">–¢–∏–ø –ø–∞—Ä—Ç–∏–∏:</p>
          <p class="font-semibold text-gray-900">
            {% if batch.batch_type == 'cutting' %}‚úÇÔ∏è –†–µ–∑–∫–∞
            {% elif batch.batch_type == 'autoclave' %}üî• –ê–≤—Ç–æ–∫–ª–∞–≤
            {% elif batch.batch_type == 'casting' %}üß± –ó–∞–ª–∏–≤–∫–∞
            {% else %}{{ batch.batch_type|title }}
            {% endif %}
          </p>
        </div>
        <div>
          <p class="text-sm text-gray-600">–ü—Ä–æ–¥—É–∫—Ç:</p>
          <p class="font-semibold text-gray-900">
            {% if batch.product %}{{ batch.product.product_code }} - {{ batch.product.name }}
            {% else %}–ù–µ —É–∫–∞–∑–∞–Ω
            {% endif %}
          </p>
        </div>
        <div>
          <p class="text-sm text-gray-600">–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ:</p>
          <p class="font-semibold text-gray-900">
            {% if batch.equipment %}{{ batch.equipment.name }}
            {% else %}–ù–µ —É–∫–∞–∑–∞–Ω–æ
            {% endif %}
          </p>
        </div>
        <div>
          <p class="text-sm text-gray-600">–í—Ä–µ–º—è –Ω–∞—á–∞–ª–∞:</p>
          <p class="font-semibold text-gray-900">{{ batch.start_time.strftime('%d.%m.%Y %H:%M') }}</p>
        </div>
        <div>
          <p class="text-sm text-gray-600">–°—Ç–∞—Ç—É—Å:</p>
          <span class="px-2 py-1 text-xs rounded-full bg-green-100 text-green-800">
            –ê–∫—Ç–∏–≤–Ω–∞
          </span>
        </div>
      </div>
    </div>

    <!-- –§–æ—Ä–º–∞ –æ—Ç–º–µ–Ω—ã -->
    <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
      <h2 class="text-lg font-semibold text-gray-900 mb-4">–ü—Ä–∏—á–∏–Ω–∞ –æ—Ç–º–µ–Ω—ã</h2>
      
      <form method="POST" action="/cancel_batch/{{ batch.id }}">
        <div class="mb-6">
          <label for="reason" class="block text-sm font-medium text-gray-700 mb-2">
            –£–∫–∞–∂–∏—Ç–µ –ø—Ä–∏—á–∏–Ω—É –æ—Ç–º–µ–Ω—ã –ø–∞—Ä—Ç–∏–∏:
          </label>
          <select id="reason" name="reason" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-red-500 focus:border-red-500" required>
            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∏—á–∏–Ω—É...</option>
            <option value="–î–µ—Ñ–µ–∫—Ç —Å—ã—Ä—å—è">–î–µ—Ñ–µ–∫—Ç —Å—ã—Ä—å—è</option>
            <option value="–ù–µ–∏—Å–ø—Ä–∞–≤–Ω–æ—Å—Ç—å –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è">–ù–µ–∏—Å–ø—Ä–∞–≤–Ω–æ—Å—Ç—å –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è</option>
            <option value="–ù–∞—Ä—É—à–µ–Ω–∏–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞">–ù–∞—Ä—É—à–µ–Ω–∏–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞</option>
            <option value="–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–æ–ø–æ—Ä—Ü–∏–∏ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤">–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–æ–ø–æ—Ä—Ü–∏–∏ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤</option>
            <option value="–ü—Ä–µ–≤—ã—à–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏">–ü—Ä–µ–≤—ã—à–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏</option>
            <option value="–ü–ª–æ—Ö–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –≥–æ—Ç–æ–≤–æ–π –ø—Ä–æ–¥—É–∫—Ü–∏–∏">–ü–ª–æ—Ö–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –≥–æ—Ç–æ–≤–æ–π –ø—Ä–æ–¥—É–∫—Ü–∏–∏</option>
            <option value="–ê–≤–∞—Ä–∏–π–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞">–ê–≤–∞—Ä–∏–π–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞</option>
            <option value="–î—Ä—É–≥–∞—è –ø—Ä–∏—á–∏–Ω–∞">–î—Ä—É–≥–∞—è –ø—Ä–∏—á–∏–Ω–∞</option>
          </select>
        </div>

        <div class="mb-6">
          <label for="custom_reason" class="block text-sm font-medium text-gray-700 mb-2">
            –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ):
          </label>
          <textarea id="custom_reason" name="custom_reason" rows="3" 
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-red-500 focus:border-red-500"
                    placeholder="–û–ø–∏—à–∏—Ç–µ –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏, –µ—Å–ª–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ..."></textarea>
        </div>

        <div class="bg-red-50 border border-red-200 rounded-md p-4 mb-6">
          <div class="flex">
            <div class="flex-shrink-0">
              <span class="text-red-400 text-lg">‚ö†Ô∏è</span>
            </div>
            <div class="ml-3">
              <h3 class="text-sm font-medium text-red-800">
                –í–Ω–∏–º–∞–Ω–∏–µ!
              </h3>
              <div class="mt-2 text-sm text-red-700">
                <p>–û—Ç–º–µ–Ω–∞ –ø–∞—Ä—Ç–∏–∏ –ø—Ä–∏–≤–µ–¥–µ—Ç –∫:</p>
                <ul class="list-disc list-inside mt-1">
                  <li>–ò–∑–º–µ–Ω–µ–Ω–∏—é —Å—Ç–∞—Ç—É—Å–∞ –Ω–∞ "–û—Ç–º–µ–Ω–µ–Ω–∞"</li>
                  <li>–ó–∞–≤–µ—Ä—à–µ–Ω–∏—é –≤—Ä–µ–º–µ–Ω–∏ —Ä–∞–±–æ—Ç—ã</li>
                  <li>–£—á–µ—Ç—É –≤ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ –±—Ä–∞–∫–∞</li>
                </ul>
              </div>
            </div>
          </div>
        </div>

        <div class="flex items-center justify-between">
          <a href="/batch_list" class="bg-gray-300 hover:bg-gray-400 text-gray-700 px-6 py-2 rounded-md font-medium transition-colors">
            –û—Ç–º–µ–Ω–∞
          </a>
          <button type="submit" 
                  class="bg-red-600 hover:bg-red-700 text-white px-6 py-2 rounded-md font-medium transition-colors"
                  onclick="return confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ—Ç–º–µ–Ω–∏—Ç—å —ç—Ç—É –ø–∞—Ä—Ç–∏—é?')">
            –û—Ç–º–µ–Ω–∏—Ç—å –ø–∞—Ä—Ç–∏—é
          </button>
        </div>
      </form>
    </div>

  </main>

  <script>
    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø–æ–ª—è –ø—Ä–∏ –≤—ã–±–æ—Ä–µ "–î—Ä—É–≥–∞—è –ø—Ä–∏—á–∏–Ω–∞"
    document.getElementById('reason').addEventListener('change', function() {
      const customReason = document.getElementById('custom_reason');
      if (this.value === '–î—Ä—É–≥–∞—è –ø—Ä–∏—á–∏–Ω–∞') {
        customReason.required = true;
        customReason.placeholder = '–£–∫–∞–∂–∏—Ç–µ –ø—Ä–∏—á–∏–Ω—É –æ—Ç–º–µ–Ω—ã...';
      } else {
        customReason.required = false;
        customReason.placeholder = '–û–ø–∏—à–∏—Ç–µ –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏, –µ—Å–ª–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ...';
      }
    });

    // –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–∏—á–∏–Ω—ã –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
    document.querySelector('form').addEventListener('submit', function(e) {
      const reason = document.getElementById('reason').value;
      const customReason = document.getElementById('custom_reason').value;
      
      if (customReason.trim()) {
        const finalReason = reason + ': ' + customReason;
        document.getElementById('reason').value = finalReason;
      }
    });
  </script>

</body>
</html>


